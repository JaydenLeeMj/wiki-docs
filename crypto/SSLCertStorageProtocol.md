
# SSL证书的存储规范

SSL证书的生成, 使用,和网络传输是网络安全领域最频繁谈论的话题, 

网络层协议: 
- TLS: 
- SSL: 
> 位于 传输层之上, 应用层之下

Cipher的选择： 话题较大，是密码学的内容，算法包含 密钥交换，对称加密，哈希，非对称加密


## 常见的存储格式

常见的SSL证书格式有哪些？常见的SSL证书格式、文件类型和协议有: PEM、DER、PFX、JKS、KDB、CER、KEY、CSR、CRT、CRL、OCSP、SCEP等。

- .p12 二进制编码秘钥
- .cer 二进制编码证书、公钥

> 签名前需要对信息哈希，一般用的是`SHA1`

> SSL证书格式主要有公钥证书格式标准`X.509`中定义的`PEM`和`DER`、公钥密码标准**PKCS**中定义的`PKCS#7`和`PKCS#12`、`Java`环境专用的`JKS`。

SSL证书的格式有以下几种：
1. PEM格式（***Privacy-Enhanced Mail***）：这是一种常见的证书格式，它使用Base64编码的ASCII文本文件。PEM格式包括证书、私钥和中间CA证书，通常以.crt、.pem或.key为扩展名。
2. DER格式（***Distinguished Encoding Rules***）：这是另一种常见的证书格式，它是二进制格式的。DER格式的证书通常以`.crt`或`.cer`为扩展名。
3. PFX或P12格式（***Personal InfORMation Exchange***）：这是一种包含**私钥和证书**的二进制格式。PFX格式的证书通常以.pfx或.p12为扩展名。
4. PKCS#7格式（***Public-Key Cryptography Standards***）：这是一种**包含证书链**的二进制格式。PKCS#7格式的证书通常以.p7b或.p7c为扩展名。
5. PKCS#12格式（***Public-Key Cryptography Standards***）：这是一种**包含私钥、证书和证书链**的二进制格式。PKCS#12格式的证书通常以.pfx或.p12为扩展名。这些证书格式可以根据具体的应用需求和系统要求

## SSL证书的类型

### DV SSL
DV SSL是 Domain Validation SSL 的缩写，指只验证网站域名所有权的简易型SSL证书，此类证书仅能起到网站机密信息加密的作用，无法向用户证明网站的真实身份。所以，不推荐在电子商务网站部署 DV SSL证书，因为电子商务首先需要的是在线信任，其次才是在线安全。

### OV SSL
OV SSL是 Organization Validation SSL 的缩写，指需要验证网站所有单位的真实身份的标准型SSL证书，此类证书也就是正常的SSL证书，不仅能起到网站机密信息加密的作用，而且能向用户证明网站的真实身份。所以，推荐在所有电子商务网站使用，因为电子商务需要的是在线信任和在线安全。从 SSL 证书的诞生史可以看出：标准型 SSL 证书就是 OV SSL证书(Organization Validation SSL)。

### EV SSL
EV SSL 是 Extended Validation SSL 的缩写，指遵循全球统一的严格身份验证标准颁发的SSL证书，是目前业界最高安全级别的SSL证书。用户访问部署了EV SSL证书的网站，不仅浏览器地址栏会显示安全锁标志，而且浏览器地址栏会变成绿色。所以，推荐所有电子商务网站都部署EV SSL证书，因为电子商务首先需要的是在线信任，其次才是在线安全。EV SSL证书，绿色安全通道，增强在线信任，促成更多在线订单。



### x.509是什么

X.509是公钥基础设施（PKI）的标准格式。X.509证书就是基于国际电信联盟（ITU）制定的X.509标准的数字证书。X.509证书主要用于识别互联网通信和计算机网络中的身份，保护数据传输安全。X.509证书无处不在，比如我们每天使用的网站、移动应用程序、电子文档以及连接的设备等都有它的身影。

X.509证书的结构优势在于它是由公钥和私钥组成的密钥对而构建的。公钥和私钥能够用于加密和解密信息，验证发送者的身份和确保消息本身的安全性。基于X.509的PKI最常见的用例是使用SSL证书让网站与用户之间实现HTTPS安全浏览。X.509协议同样也适用于应用程序安全的代码签名、数字签名和其他重要的互联网协议。

> by dereckleemj@gmail.com 
> X.509 是SSL 现在使用的证书存储格式，是一种抽象语法的产物，即ASN.1


### 服务器环境下适合使用哪种的证书格式？

PEM是基于编码的证书格式，**扩展名包括pem, crt和cer**。Linux系统使用crt，Windows系统使用cer。PEM证书通常将**根证书**、**中间证书**和**用户证书**分开存放，主要用于`Apache server`和`Nginx`。

Summary: 
- Linux: PEM file 后缀名一般是 .crt
- 常见的Web server如 Apache, nginx 也是使用 .crt 
- CA颁发的证书 一般PEM 或者 PKCS#7 进行编码
- DER 是一种不编码的方案；直接存储二进制的数据

#### `.crt` 文件
`.crt`是用于存放证书，它是2进制形式存放的。

Ngnix服务器和Apache服务器使用`.crt`格式的证书文件。

`DER`是基于二进制编码的证书格式，扩展名包括`der`、`crt`和`cer`。`DER`证书相当于`PEM`证书的二进制版本，主要用于Java平台。

`PKCS#7`是基于编码的证书格式，扩展名包括p7b和p7c。PKCS#7证书通常将根证书和中间证书合并存放，将用户证书单独存放。PKCS#7证书不包含私钥，主要用于Tomcat和Windows Server。

`PKCS#12`是基于二进制编码的证书格式，扩展名包括pfx和p12。PKCS#12证书通常将根证书、中间证书、用户证书和私钥合并存放并设置密码，主要用于Windows Server。

`JKS`是是基于二进制编码的证书格式，扩展名是`.jks`。`JKS`证书通常将根证书、中间证书、用户证书和私钥合并存放并设置密码，主要
用于Java Web Server。

#### `.PKCS12` 文件
同时包含**证书**和**私钥**，通常有密码保护，2进制方式。

IIS服务器使用PFX（即PKCS12或P12）格式的证书文件。

JKS格式：Tomcat服务器使用JKS格式的证书文件。

证书颁发机构CA签发的证书通常是`PEM`格式或`PKCS#7`格式，而`PKCS#12`格式和`JKS`格式的证书需要进行证书格式转换才能得到。我们可以通过`OpenSSL`、`Keytool`或在线证书转换工具等方式将`PEM`格式或`PKCS#7`格式的证书转换为我们需要的其他格式。

